"use strict";(self.webpackChunkpolaris_support=self.webpackChunkpolaris_support||[]).push([[5314],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>k});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=a.createContext({}),p=function(e){var t=a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(r),d=n,k=u["".concat(l,".").concat(d)]||u[d]||m[d]||o;return r?a.createElement(k,i(i({ref:t},c),{},{components:r})):a.createElement(k,i({ref:t},c))}));function k(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:n,i[1]=s;for(var p=2;p<o;p++)i[p]=r[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},2852:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var a=r(7462),n=(r(7294),r(3905));const o={},i="Custom Rules",s={unversionedId:"security-center/rules/custom-rules",id:"security-center/rules/custom-rules",title:"Custom Rules",description:"Polaris allows users to create custom rules so that the website properly responds to each request as it passes through Polaris. Each",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/security-center/rules/custom-rules.mdx",sourceDirName:"security-center/rules",slug:"/security-center/rules/custom-rules",permalink:"/polaris-support-test-site/en/docs/security-center/rules/custom-rules",draft:!1,editUrl:"https://github.com/polaris-infosec/polaris-support/blob/master/docs/security-center/rules/custom-rules.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Content Security Policy (CSP)",permalink:"/polaris-support-test-site/en/docs/security-center/rules/csp"},next:{title:"N-Day & New Attack Vectors",permalink:"/polaris-support-test-site/en/docs/security-center/rules/n-day"}},l={},p=[],c={toc:p},u="wrapper";function m(e){let{components:t,...o}=e;return(0,n.kt)(u,(0,a.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"custom-rules"},"Custom Rules"),(0,n.kt)("p",null,"Polaris allows users to create custom rules so that the website properly responds to each request as it passes through Polaris. Each\nrule contains the rule's name, condition, and action to take based on the rule's condition."),(0,n.kt)("p",null,"To access this feature, go to ",(0,n.kt)("inlineCode",{parentName:"p"},"Settings"),":"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Setting Tab",src:r(1242).Z,width:"497",height:"361"})),(0,n.kt)("p",null,"Under ",(0,n.kt)("inlineCode",{parentName:"p"},"SITES"),", select your domain and click on ",(0,n.kt)("inlineCode",{parentName:"p"},"Settings"),"."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Custom Rule Tab",src:r(5441).Z,width:"975",height:"463"})),(0,n.kt)("p",null,"Click on the ",(0,n.kt)("inlineCode",{parentName:"p"},"Rules")," tab and select ",(0,n.kt)("inlineCode",{parentName:"p"},"Custom"),"."),(0,n.kt)("p",null,"To add a new custom rule, click the green ",(0,n.kt)("inlineCode",{parentName:"p"},"Add Rule")," button and a window will appear:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Add Rule",src:r(5019).Z,width:"975",height:"452"})),(0,n.kt)("p",null,"You can customize your new rule here."),(0,n.kt)("p",null,"These parameters help you customize your rule:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Rule name"),": A specific name to distinguish your rule from other rules.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Determining Rule Conditions"),"\na. ",(0,n.kt)("strong",{parentName:"p"},"Parameters to check"),". When the request comes in, Polaris checks the information that matches this parameter, the available parameters are:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre"},"  - AS Num\n  - Cookie\n  - Country\n  - Hostname\n  - IP Address\n  - Referer\n  - Request Method\n  - URI Full\n  - URI Path\n  - User Agent\n  - Threat Score (Threat scale from 1 to 100)\n")),(0,n.kt)("p",{parentName:"li"},"b. ",(0,n.kt)("strong",{parentName:"p"},"Operator"),". The operator determines how Polaris compares the selected parameter, the available options are:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre"},"-   equals\n-   does not equal\n-   is in\n-   is not in\n-   greater than\n-   less than\n-   greater than or equal to\n-   less than or equal to\n")),(0,n.kt)("p",{parentName:"li"},"c. ",(0,n.kt)("strong",{parentName:"p"},"Value"),": Specify the value for the parameter and operator to compare."),(0,n.kt)("p",{parentName:"li"},"d. ",(0,n.kt)("strong",{parentName:"p"},"Logic function"),". This function can be used to customize the rule to make it more precise because it allows you to add a parameter,\noperator and another operator value in the same rule. However, the use of logical functions is optional, functions that can\navailable is:"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre"},"-   **AND**: to match other conditions / all in the same rule.\n-   **OR**: to match at least one of many conditions in the same rule.\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Action taken by Polaris"),". This determines the appropriate part for Polaris to perform if the parameter,\noperator and operator value match, the following available actions are:"))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Allowed"),": Polaris allows requests to be forwarded for processing and response."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Blocked"),": request denied and response with status code HTTP 403 (Forbidden)."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"JS Challenged"),": Polaris will run a JavaScript validation challenge before users can view the content."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Challenged (Captcha)"),": Polaris will show Captcha challenge before user can view the content."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Log"),": Polaris will post it as a security event if it matches the custom rule action."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Redirect"),": Polaris redirects web traffic to another server."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Rewrite URI"),": Polaris updates a specific section of the URI with new information."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Rewrite Header"),": Polaris updates a specific section of the request header with new information. See below for more details."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Remove Header"),": Polaris removes headers from request."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Rewrite Cookie"),": Polaris updates the information in the cookie. See below for more details."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Remove Cookie"),": Polaris remove cookie."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Set Origin IPs"),"."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Browser Integrity Check"),": See this article for more details.")),(0,n.kt)("p",null,"That's it, your new custom rule has been created! You can turn on/off and update the law at any time."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Rewrite Header")),(0,n.kt)("p",null,"To rewrite header, need to provide the following information:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Rewrite Header",src:r(7582).Z,width:"975",height:"457"})),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Header Name")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Rewrite from")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Rewrite to")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Rewrite response"),": Polaris will redirect it to its original request"),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Rewrite add if missing"),": In case the header does not exist, Polaris will add an empty string to the header when this option is enabled.")),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Rewrite cookie")),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Rewrite Cookie",src:r(8893).Z,width:"975",height:"434"})),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Cookie Name")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Rewrite from")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Rewrite to")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Rewrite add if missing"),": If the cookie does not exist, Polaris will add an empty string to the cookie when this option is enabled.")))}m.isMDXComponent=!0},1242:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/settings-tab-8c663242d837cb0d04edb6f428ed0a8f.png"},5019:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/custom-rules-add-rule-c4e3dcc3cb87bb0cbaa1ccbb742659e0.png"},8893:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/custom-rules-rewrite-cookie-e6991b659c733d88e8b25b24fd8bf0a1.png"},7582:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/custom-rules-rewrite-header-9b534ccc068b94ec0f4e850ca5687be9.png"},5441:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/custom-rules-tab-6499e989ca0b260f6f2a20b32da985ea.png"}}]);