"use strict";(self.webpackChunkpolaris_support=self.webpackChunkpolaris_support||[]).push([[8150],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),h=o,m=u["".concat(l,".").concat(h)]||u[h]||d[h]||a;return n?r.createElement(m,i(i({ref:t},c),{},{components:n})):r.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:o,i[1]=s;for(var p=2;p<a;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},3977:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var r=n(7462),o=(n(7294),n(3905));const a={},i="Content Security Policy (CSP)",s={unversionedId:"security-center/rules/csp",id:"security-center/rules/csp",title:"Content Security Policy (CSP)",description:"What is CSP?",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/security-center/rules/csp.mdx",sourceDirName:"security-center/rules",slug:"/security-center/rules/csp",permalink:"/polaris-support-page/en/docs/security-center/rules/csp",draft:!1,editUrl:"https://github.com/polaris-infosec/polaris-support-page/blob/master/docs/security-center/rules/csp.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Quy t\u1eafc",permalink:"/polaris-support-page/en/docs/category/quy-t\u1eafc"},next:{title:"Custom Rules",permalink:"/polaris-support-page/en/docs/security-center/rules/custom-rules"}},l={},p=[{value:"What is CSP?",id:"what-is-csp",level:2},{value:"How does CSP work?",id:"how-does-csp-work",level:2},{value:"Implementing CSP with Polaris",id:"implementing-csp-with-polaris",level:2},{value:"Policies",id:"policies",level:2},{value:"Reports",id:"reports",level:2}],c={toc:p},u="wrapper";function d(e){let{components:t,...a}=e;return(0,o.kt)(u,(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"content-security-policy-csp"},"Content Security Policy (CSP)"),(0,o.kt)("h2",{id:"what-is-csp"},"What is CSP?"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Content Security Policy (CSP)")," is a browser mechanism that can help to prevent some types of\ncross-site scripting (XSS), clickjacking and other code injection attacks that result from the\nexecution of malicious content in the trusted web page context. It works by restricting the\nresources (such as scripts and images) that a page can load and restrict whether a page can be\nframed by other pages. CSP itself is supported by all the major modern browsers."),(0,o.kt)("p",null,"While a strong CSP can provide an effective second layer of protection against various types of\nattacks, it is not intended as a first line of defense against content injection vulnerabilities. CSP\nis best used as defense-in-depth. It reduces the harm that a malicious injection can cause, but it\nis not a replacement for careful input validation and output encoding."),(0,o.kt)("h2",{id:"how-does-csp-work"},"How does CSP work?"),(0,o.kt)("p",null,"CSP can be implement in various ways. The most preferred approach would be to use the\nContent-Security-Policy or Content-Security-Policy-Report-Only HTTP response header field.\nThe browsers use the rules defined in these headers to control the resources the user agent is\nallowed to load for a given page. A detailed explanation on CSP can be found ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"},"here"),"."),(0,o.kt)("h2",{id:"implementing-csp-with-polaris"},"Implementing CSP with Polaris"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Setting Tab",src:n(8416).Z,width:"497",height:"361"})),(0,o.kt)("p",null,"First, go to ",(0,o.kt)("inlineCode",{parentName:"p"},"Settings")," of the selected site."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"CSP Tab",src:n(5263).Z,width:"975",height:"475"})),(0,o.kt)("p",null,"Click on ",(0,o.kt)("inlineCode",{parentName:"p"},"CSP")," to configure it."),(0,o.kt)("h2",{id:"policies"},"Policies"),(0,o.kt)("p",null,"In the ",(0,o.kt)("strong",{parentName:"p"},"Policies")," tab, you are able to configure CSP settings for your webpage."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"CSP Policies Tab",src:n(9754).Z,width:"975",height:"669"})),(0,o.kt)("p",null,"CSP Policies Page"),(0,o.kt)("p",null,"There are two main settings on this page:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Blocking")," / ",(0,o.kt)("strong",{parentName:"p"},"Not blocking"),": Chooses whether CSP is enforced on the webpage")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Reporting")," / ",(0,o.kt)("strong",{parentName:"p"},"Not reporting"),": Choose whether you would like to store reports on threats that\nhave violated CSP on the webpage."),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"You may opt for a **Report-Only mode** by deploying CSP and not enforcing it (Set blocking\nto off and reporting to on), it will report any violations to the policy under the 'Reporting' tab\nbut not actually enforce and block any of them.\n\nOne of the reasons this is done is so you may experiment, observe, and monitor the CSP,\nand craft a better CSP using the reports produced. More details on the report are covered\nbelow.\n")))),(0,o.kt)("p",null,"There are additional inline script settings to configure CSP's protection against XSS attacks:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Allow unsafe inline scripts"),": Allows the webpage to include arbitrary script tags"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Allow eval() in script tags"),": Allows scripts in the webpage to execute code using an eval() function"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Allow unsafe inline style definitions"),": Allow the webpage to include arbitrary style tags")),(0,o.kt)("p",null,"You are also able to make custom directives to allow your page to load resources from third\nparty domains."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"CSP Directives",src:n(2617).Z,width:"975",height:"316"})),(0,o.kt)("p",null,"There is also a section below which lets you review which headers have been configured, as\nwell as how secure certain components are to XSS attacks:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"CSP Preview",src:n(874).Z,width:"975",height:"535"})),(0,o.kt)("h2",{id:"reports"},"Reports"),(0,o.kt)("p",null,"The reports page has records of all activities which have been blocked by the CSP rules. Do\nnote that for the report to be generated, ",(0,o.kt)("inlineCode",{parentName:"p"},"Reporting")," has to be turned on under CSP's Advanced\nSettings."),(0,o.kt)("p",null,"Below is an example of how the ",(0,o.kt)("inlineCode",{parentName:"p"},"Reports")," page could look when this setting is turned on:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"CSP Report Tab",src:n(8123).Z,width:"1212",height:"734"})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Version"),": The version number of the CSP. It can be found in the preview under the ",(0,o.kt)("inlineCode",{parentName:"p"},"Policies")," function.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Directive"),": The directive that caused the violation.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Last Time"),": Last recorded date & time of violation.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Count"),": The number of times it was recorded.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Blocked URI"),": The URI of the resource that was blocked from loading by the CSP."),(0,o.kt)("p",{parentName:"li"},"Apart from the details displayed about the violated CSP, there are also 2 action choices:")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Allow"),": The blocked rule will be added to the CSP header.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Ignore"),": Removes it from the list."))))}d.isMDXComponent=!0},8416:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/settings-tab-8c663242d837cb0d04edb6f428ed0a8f.png"},2617:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/csp-directives-f73532fbf89f78832849fcf62f06b37a.png"},9754:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/csp-policies-tab-ba7d2dc7dd0975c43425d1bf877eae24.png"},874:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/csp-preview-b1851618c867fbf1d43db80efe58f950.png"},8123:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/csp-report-tab-302f45a1142aa7184b2d2a5fd254d6cc.png"},5263:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/csp-tab-46195c0e691e735f76a4a2b0cbb369ac.png"}}]);